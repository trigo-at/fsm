<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../">
  <title data-ice="title">lib/parse-transition-api.js | API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/composit-state.js~CompositState.html">CompositState</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/lib/fsm.js~FSM.html">FSM</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-findpossibletransitions">findpossibletransitions</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isvalidstatevalue">isvalidstatevalue</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">lib/parse-transition-api.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">&apos;use strict&apos;;

function getNested(theObject, path) {
	try {
		const separator = &apos;.&apos;;

		return path
			.replace(&apos;[&apos;, separator).replace(&apos;]&apos;, &apos;&apos;)
			.split(separator)
			.reduce(
				(obj, property) =&gt; obj[property], theObject,
			);
	} catch (err) {
		return undefined;
	}
}

const replaceFromParams = (path, params, ctx) =&gt; {
	let href = path;
	Object.keys(params).forEach((key) =&gt; {
		const value = getNested(ctx, params[key]);
		if (value === undefined) {
			throw new Error(`Cannot resolve param: &quot;${key}&quot; data path: &quot;${params[key]}&quot;`);
		}
		href = href.replace(new RegExp(`{${key}}`, &apos;g&apos;), value);
	});

	return href;
};

const extractParams = (path) =&gt; {
	const matches = path.match(/\{.*?\}/g);
	if (!matches) return undefined;
	const params = {};
	matches.forEach((m) =&gt; {
		params[m.replace(/\{/, &apos;&apos;).replace(/\}/, &apos;&apos;)] = true;
	});
	return params;
};

/** @private */
module.exports = ({ api, ctx }) =&gt; {
	if (!api) throw new Error(&apos;Argument &quot;api&quot; missing&apos;);
	if (!api.path) throw new Error(&apos;Argument &quot;api.path&quot; missing&apos;);

	const method = api.method || &apos;get&apos;;

	let href = api.path;
	if (ctx &amp;&amp; ctx.api &amp;&amp; ctx.api.params) {
		href = replaceFromParams(href, ctx.api.params, ctx);
	}
	if (api.params) {
		href = replaceFromParams(href, api.params, ctx);
	}

	const params = extractParams(href);

	const link = {
		href,
		method,
	};

	if (params) {
		link.params = params;
	}
	return link;
};
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.5.2)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
